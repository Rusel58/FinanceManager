# Accounting for Finance

## Общее описание проекта

**Accounting for Finance** – это приложение для управления финансовыми данными пользователей. Проект позволяет:
- Создавать, редактировать и удалять банковские счета, категории и операции (доходы и расходы).
- Выполнять аналитику: подсчёт разницы между доходами и расходами, группировку операций по категориям.
- Импортировать и экспортировать данные в форматах CSV, JSON и YAML.
- Пересчитывать баланс счёта на основе операций.
- Измерять время выполнения ключевых бизнес-процессов с помощью паттерна «Команда» и декоратора.

### Описание логики и выбранных путей решения

При создании операции меняется баланс счета (увеличивается/уменьшается в зависимости от категории), 
соответственно тип операции совпадает в типом категории. Также при Expense невозможно 
создать операцию, где сумма превышает баланс, это прописано в OperationModule. При чтении будет выбрасываться
ошибка из класса BankAccount, при снятии стоит проверка хватает ли средств на балансе.
При чтении из файла для создания объектов используется фасад, для создания пользователем используется Команда.
Пересчет баланса проверяет превышают ли расходы текущий баланс и добавляет недостающую сумму.
Также программа использует самописный класс для более красивого вывода в консоль.
При редактировании счета можно менять только название (исходя из логики, внести/снять можно с помощью операции), 
в операции можно изменить только описание, в категории также можно изменить только название.
Измерение времени работы пользовательских сценариев считает время под капотом, не учитывается ввод названий, баланса, 
только время работы кода, поэтому часто получается 0мс.


## Структура проекта

```bash
Ниже представлена примерная структура каталогов и файлов в проекте:
Accounting_for_finance/
├── Application/
│   ├── Analytics/
│   │   └── AnalyticsFacade.cs
│   ├── Commands/
│   │   ├── CalculateIncomeExpenseDifferenceCommand.cs
│   │   ├── CalculateSumByCategoryCommand.cs
│   │   ├── CreateAccountCommand.cs
│   │   ├── CreateCategoryCommand.cs
│   │   ├── CreateOperationCommand.cs
│   │   ├── DeleteAccountCommand.cs
│   │   ├── DeleteCategoryCommand.cs
│   │   ├── DeleteOperationCommand.cs
│   │   ├── ICommand.cs
│   │   ├── RecalculateBalanceCommand.cs
│   │   ├── UpdateAccountCommand.cs
│   │   ├── UpdateCategoryCommand.cs
│   │   └── UpdateOperationDescriptionCommand.cs
│   ├── Decorators/
│   │   └── TimedCommand.cs
│   ├── ImportExport/
│   │   ├── CsvExportVisitor.cs
│   │   ├── CsvImport.cs
│   │   ├── EmptyStringToDateTimeConverter.cs
│   │   ├── EmptyStringToDecimalConverter.cs
│   │   ├── EmptyStringToGuidConverter.cs
│   │   ├── IExportVisitor.cs
│   │   ├── ImportTemplate.cs
│   │   ├── JsonImport.cs
│   │   ├── YamlExportVisitor.cs
│   │   └── YamlImport.cs
│   ├── Services/
│   │   ├── BalanceRecalculator.cs
│   ├── BankAccountFacade.cs
│   ├── CategoryFacade.cs
│   ├── OperationFacade.cs
│   └── AnalyticsFacade.cs
├── Domain/
│   ├── BankAccount.cs
│   ├── Category.cs
│   ├── DomainFactory.cs
│   └── Operation.cs
├── Infrastructure/
│   └── DIContainer.cs
├── Presentation/
│   ├── DataProcess/
│   │   ├── AnalyticsModule.cs
│   │   ├── BalanceModule.cs
│   │   ├── BankAcountModule.cs
│   │   ├── CategoryModule.cs
│   │   └── OperationModule.cs
│   ├── InOut/
│   │   ├── Input.cs
│   │   └── Output.cs
│   ├── IOController/
│   │   └── ConsoleController.cs
│   ├── InOut/
│   │   ├── ReadProcesses.cs
│   │   └── WriteProcesses.cs
│   ├── ConsoleUI.cs
│   ├── Program.cs
│──  README.md
│──  TestFiles
│   └── BankSystemCsv.csv
│   └── BankSystemJson.json
└── └── BankSystemYaml.yaml
```

## Функциональные возможности

- **Учет финансов:**  
  - Банковские счета – создание, обновление, удаление.
  - Категории – создание, обновление, удаление.
  - Операции – создание, обновление описания, удаление с автоматическим изменением баланса счёта (при доходе – баланс увеличивается, при расходе – уменьшается).

- **Аналитика:**  
  - Подсчёт разницы доходов и расходов за заданный период.
  - Группировка операций по категориям с расчетом сумм.

- **Импорт/Экспорт:**  
  - Импорт и экспорт данных в форматах CSV, JSON, YAML с использованием шаблонного метода (Template Method).

- **Пересчет баланса:**  
  - Сервис пересчета баланса (BalanceRecalculator), который анализирует операции и корректирует баланс счёта, если обнаруживаются несоответствия.

- **Измерение времени:**  
  - Использование паттерна «Команда» для инкапсуляции бизнес-операций.
  - Декоратор `TimedCommand` оборачивает команды для измерения времени их выполнения (только бизнес-логика, без учета времени ввода данных).

## Принципы SOLID и GRASP

### SOLID
- **SRP (Single Responsibility Principle):**  
  Каждый класс отвечает за свою задачу. Например, классы доменной модели (`BankAccount`, `Category`, `Operation`) отвечают только за представление данных и бизнес-логику, а фасады (например, `BankAccountFacade`) – за операции над ними.

- **OCP (Open/Closed Principle):**  
  Система легко расширяется новыми сценариями (например, новыми командами или декораторами) без модификации существующего кода.

- **LSP (Liskov Substitution Principle):**  
  Компоненты реализуют интерфейсы (например, `ICommand`), что позволяет использовать их взаимозаменяемо.

- **ISP (Interface Segregation Principle):**  
  Интерфейсы, такие как `ICommand`, содержат только необходимые методы, что упрощает их реализацию и тестирование.

- **DIP (Dependency Inversion Principle):**  
  Модули зависят от абстракций (интерфейсов и фасадов), а не от конкретных реализаций, что упрощает замену компонентов через DI-контейнер.

### GRASP
- **High Cohesion:**  
  Функциональность разделена по модулям. Например, аналитика инкапсулирована в сервисе `AnalyticsFacade`, а операции – в `OperationFacade`.

- **Low Coupling:**  
  Компоненты взаимодействуют через четко определённые интерфейсы и фасады, что снижает зависимость между ними и упрощает тестирование и модификацию.

## Реализованные паттерны GoF

- **Фабрика (Factory):**  
  Используется в классе `DomainFactory` для создания объектов доменной модели (например, `BankAccount`, `Category`, `Operation`). Это обеспечивает централизованное создание объектов с соблюдением правил валидации и бизнес-логики.

- **Фасад (Facade):**  
  Фасады (`BankAccountFacade`, `CategoryFacade`, `OperationFacade`, `AnalyticsFacade`) предоставляют упрощённый интерфейс для работы с бизнес-логикой и скрывают внутренние детали реализации.

- **Команда (Command):**  
  Каждый пользовательский сценарий (создание, обновление, удаление объектов) инкапсулируется в отдельные команды (например, `CreateOperationCommand`, `UpdateAccountCommand`, `DeleteCategoryCommand`). Это позволяет отделить бизнес-логику от интерфейса и облегчает добавление таких функциональностей, как логирование, измерение времени выполнения или отмена операции.

- **Декоратор (Decorator):**  
  Декоратор `TimedCommand` оборачивает команды для измерения времени их выполнения. Это добавляет аспект измерения времени, не изменяя внутреннюю логику команд.

- **Шаблонный метод (Template Method):**  
  ImportTemplate определяет общий алгоритм импорта (чтение файла, парсинг, валидация, сохранение).
  Различные импортеры (CsvImport, JsonImport, YamlImport) переопределяют только метод парсинга.

- **Посетитель (Visitor):**  
  IExportVisitor и реализации (например, CsvExportVisitor, YamlExportVisitor) для обхода объектов доменной модели и записи в разные форматы.

## Архитектура проекта

- **Domain Layer:**  
  Содержит классы доменной модели (например, `BankAccount`, `Category`, `Operation`) и фабрику (`DomainFactory`).

- **Application Layer:**  
  Содержит фасады (например, `BankAccountFacade`, `CategoryFacade`, `OperationFacade`, `AnalyticsFacade`), сервисы (например, `BalanceRecalculator`), команды (например, `CreateOperationCommand`, `UpdateAccountCommand`), декораторы (например, `TimedCommand`) и прочие компоненты бизнес-логики.

- **Infrastructure Layer:**  
  DI-контейнер.

- **Presentation Layer:**  
  Отвечает за взаимодействие с пользователем (например, `ConsoleUI`, модули `DataProcess`, классы `Input` и `ConsoleController`).

## Инструкции по запуску

1. **Сборка проекта:**  
   Используйте Visual Studio или выполните команду `dotnet build` для сборки решения.

2. **Запуск приложения:**  
   Запустите приложение (через Visual Studio или командой `dotnet run`). Приложение откроется в консольном окне, где вы сможете выбирать необходимые операции через меню.

3. **Тестирование функциональности:**  
   Следуйте инструкциям консольного интерфейса для создания, редактирования и удаления банковских счетов, категорий и операций. Аналитические функции, импорт/экспорт и пересчёт баланса доступны через соответствующие разделы меню.

4. **Тестирование чтения и записи:**
   В папке TestFiles лежит три файла разных форматов для чтения.
   Файлы сохраняются в "bin/Debug/net8.0/".

## Заключение

Проект **Accounting for Finance** реализован с соблюдением принципов SOLID и GRASP, а также с использованием паттернов проектирования GoF (Фабрика, Фасад, Команда, Декоратор, Прокси). Такой подход позволяет:
- Создавать масштабируемые, легко поддерживаемые и расширяемые приложения.
- Разделять обязанности между компонентами, что упрощает тестирование и дальнейшее развитие.
- Добавлять дополнительные аспекты (например, логирование, измерение времени, отмену операций) через декораторы и команды.